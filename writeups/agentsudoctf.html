<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Yashwardhan Laharia</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.2.6/gsap.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans&display=swap" rel="stylesheet">

  <!--favicon-img-->
  <link rel="icon" type="image/png" href="../images/favicon.jpg">
  <!--favicon-img-->

  <link rel="stylesheet" href="../css/index.css">


</head>

<body>
  <main id="blog-single">


    <!-- CUSTOM CURSOR -->
    <div class="cursor scale"></div>
    <div class="cursor-two scale"></div>
    <!-- CUSTOM CURSOR -->

    <!-- PRELOADER -->
    <div id="preloader">
      <!-- <div class="p">
                  <img src="images/headphone.png" alt="headphone">
              </div> -->
      <div class="p">Agent Sudo CTF</div>
    </div>
    <!-- PRELOADER -->


    <div id="blog-single-content">

      <!-- NAVIGATION -->
      <div class="navigation">
        <div class="logo hover ">
          <a href="../index.html" class="text">Yashwardhan Laharia</a>
        </div>
        <div class="menu-bar hover ">
          <div class="menu-bar-name text">
            Menu
          </div>
          <div class="menu-bar-lines text">
            <div class="menu-bar-line"></div>
            <div class="menu-bar-line"></div>
          </div>
        </div>
      </div>
      <!-- NAVIGATION -->



      <!-- HEADING -->
      <div class="heading">
        <div class="text">
          Agent Sudo
        </div>
      </div>

      <!-- HEADING -->

      <div class="center">


        <!-- BLOG IMG -->
        <div class="blog-img img">

          <img src="../images/agentsudoctf/agent_sudo.png" alt="blog-img">

        </div>
        <!-- BLOG IMG -->



        <div class="center-para">

          <!-- BLOG TEXT -->
          <div class="blog-text">


            <!-- BLOG INFO -->

            <div class="blog-info">
              <div class="blog-date text-scroll"><a
                  href="https://tryhackme.com/room/agentsudoctf">https://tryhackme.com/room/agentsudoctf</a></div>
            </div>
            <!-- BLOG INFO -->


            <!-- BLOG HEADING -->
            <div class="blog-heading text-scroll">
              You found a secret server located under the deep sea. Your task is to hack inside the server and reveal
              the truth.
            </div>

            <!-- BLOG HEADING -->


            <!-- PARAGRAPH -->
            <div class="blog-sub-heading text-scroll">
              Ennumeration
            </div>
            <!-- PARAGRAPH -->


            <br />

            <!-- PARAGRAPH -->
            <div class="para text-scroll">
              Let's run nmap for some basic ennumeration to get an idea for what we are working with.
            </div>
            <!-- PARAGRAPH -->
            <br />
            <div class="text-scroll">
              <code>
              nmap -sC -sV -v -o nmap_scan {ip}
            </code>
            </div>
            <br />
            <div class="para text-scroll">
              Which gives the following output:
            </div>
            <br />
            <div class="text-scroll">
              <pre><code>
# Nmap 7.93 scan initiated Fri Jun 23 22:15:51 2023 as: nmap -sC -sV -v -o nmap_scan 10.10.67.193
Increasing send delay for 10.10.67.193 from 0 to 5 due to 97 out of 321 dropped probes since last increase.
Increasing send delay for 10.10.67.193 from 5 to 10 due to 11 out of 36 dropped probes since last increase.
Increasing send delay for 10.10.67.193 from 10 to 20 due to 11 out of 30 dropped probes since last increase.
Increasing send delay for 10.10.67.193 from 20 to 40 due to 11 out of 13 dropped probes since last increase.
Increasing send delay for 10.10.67.193 from 40 to 80 due to 11 out of 15 dropped probes since last increase.
Increasing send delay for 10.10.67.193 from 80 to 160 due to 11 out of 13 dropped probes since last increase.
Nmap scan report for 10.10.67.193
Host is up (0.19s latency).
Not shown: 997 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 ef1f5d04d47795066072ecf058f2cc07 (RSA)
|   256 5e02d19ac4e7430662c19e25848ae7ea (ECDSA)
|_  256 2d005cb9fda8c8d880e3924f8b4f18e2 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Annoucement
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Fri Jun 23 22:17:46 2023 -- 1 IP address (1 host up) scanned in 115.33 seconds
              </code></pre>
            </div>
            <br />

            <div class="para text-scroll">
              We have ports 21, 22 and 80 open.
            </div>

            <br />

            <div class="blog-sub-heading text-scroll">
              Port 21 FTP
            </div>

            <div class="para text-scroll">
              Attempting to access the server as an Anonymous user fails. We need to find agent codenames, which will be
              the usernames we use to login.
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/first_lftp.png" alt="img">
              </div>
            </div>

            <br />
            <div class="blog-sub-heading text-scroll">
              Port 22 SSH
            </div>

            <br>
            <div class="para text-scroll">
              Attempting basic ssh, the sever is obviously password protected.
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/first_ssh.png" alt="img">
              </div>
            </div>

            <br />
            <div class="blog-sub-heading text-scroll">
              Port 80
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/initial.png" alt="img">
              </div>
            </div>

            <div class="blog-sub-heading text-scroll">
              User Agent Shenanigans
            </div>

            <br>
            <div class="text-scroll para">
              Using the <u><a href="https://add0n.com/useragent-switcher.html">User Agent Switcher</a></u> extension, I
              changed my user agent to <b>R</b>
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/user_agent_R.png" alt="img">
              </div>
            </div>

            <br>
            <div class="text-scroll para">
              "Are you one of the 25 employees?" including the letter <b>R</b>, it makes it 26 employees. The english
              alphabet has 26 letters, so I'm guessing the agent names are these english letter characters. Let me try
              change the useragent to the first few characters of the english alphabet.<br><br>I get the following page
              on <b>C</b>
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/user_agent_C.png" alt="img">
              </div>
            </div>

            <br>
            <div class="text-scroll para">
              Bingo, we now know Agent <B>C</B>'s name is <b>Chris</b>. We also know that an Agent <b>J</b> now exists.
              However, i tried User Agent <b>J</b> but it leads nowhere.
            </div>

            <br>
            <div class="text-scroll para">
              Let's run gobuster to find more directories on the web server just to be sure we don't miss on anything.
            </div>

            <br>
            <div class="text-scroll">
              <!-- <pre> -->
              <code>
                  gobuster -u {ip} -w /usr/share/wordlists/dirb/common.txt dir -o dir_scan
                </code>
              <!-- </pre> -->
            </div>

            <br>
            <div class="text-scroll para">
              Which gives the following directories:
            </div>

            <br>
            <div class="text-scroll">
              <pre>
                <code>
/.hta                 (Status: 403) [Size: 277]
/.htaccess            (Status: 403) [Size: 277]
/.htpasswd            (Status: 403) [Size: 277]
/index.php            (Status: 200) [Size: 218]
/server-status        (Status: 403) [Size: 277]
                </code>
              </pre>
            </div>

            <br>
            <div class="text-scroll para">
              Nothing meaningful here, so we can now proceed to logging in via FTP again. We know a valid user, Chris.
              Their password can be bruteforced with hydra.
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/hydra_ftp.png" alt="img">
              </div>
            </div>

            <div class="text-scroll para">
              I'll now log into the FTP server via the credentials chris:crystal
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/successful_ftp_chris.png" alt="img">
              </div>
            </div>

            <div class="text-scroll para">
              Success! I list the files in the directory and download them to my system via <b>mget</b>. Reading the
              <b>To_agentJ.txt</b> shows that agent R has steganographically embedded Agent J's password in the alien
              pictures.<br><br> Following are the alien pictures which contain the password; <b>cute-alien.jpg</b> and
              <b>cutie.png</b> respectively.
            </div>

            <!-- IMAGES -->
            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/cute-alien.jpg" alt="img">
              </div>
              <div class="img-scroll">
                <img src="../images/agentsudoctf/cutie.png" alt="img">
              </div>
            </div>

            <div class="text-scroll para">
              I tried <b>Steghide</b> and <b>ExifTool</b> on <b>Cutie.png</b> but nothing of use was output. In a
              hit-and-trial effort, i ran it through <b>Binwalk</b> which gave me the following:
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/binwalk_cutie.png" alt="img">
              </div>
            </div>

            <div class="text-scroll para">
              Each of these files is password protected. <b>John to the rescue!!!!</b>
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/john_crack.png" alt="img">
              </div>
            </div>

            <div class="text-scroll para">
              The password is <b>alien</b>. <i>Who could have known</i> lol.<br><br>Anyhow, unzip command still failed
              to unzip the zipped file for some reason, so a little research later i tried out <b>7zip</b>
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/cracked_zips.png" alt="img">
              </div>
            </div>

            <div class="text-scroll para">
              I read <b>To_agentR.txt</b>. I didn't want to sit and manually decypher "QXJlYTUx", so I just put it into
              cyberchef and let it do it's <i>magic</i> :)
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/to_agent_r.png" alt="img">
              </div>
              <div class="img-scroll">
                <img src="../images/agentsudoctf/cyber_chef_magic.png" alt="img">
              </div>
            </div>

            <div class="text-scroll para">
              Unless I've missed something so far, I don't know how to contact <b>Area51</b> that I have their pictures
              with me. Soooo im guessing it's a password for something. Now to cracking the other alien
              picture.<br><br>Steghide asks me for a password, and guess what? It's Area51 yay!
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/james.png" alt="img">
              </div>
            </div> 

            <div class="text-scroll para">
              I now have another set of credentials, james:hackerrules!. Let's SSH into James.
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/james_pwned.png" alt="img">
              </div>
            </div>

            <div class="text-scroll para">
              That works! I have the user flag now. Ill check out Alien_autospy.jpg and then continue to root the
              machine.
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/alien_autopsy.png" alt="img">
              </div>

              <div class="img-scroll">
                <img src="../images/agentsudoctf/da_alien.png" alt="img">
              </div>
            </div>
            <br>
            <div class="blog-sub-heading text-scroll">
              Root
            </div>
            <br>
            <div class="text-scroll para">
              I'm lazy so i just load linpeas into /dev/shm and let it do it's thing for me.
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/get_linpeas.png" alt="img">
              </div>
            </div>

            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/linp_output.png" alt="img">
              </div>
            </div>

            <div class="text-scroll para">
              I have no idea what LXD is so ill just exploit Pkexec instead, it's wayyy easier than researching
              something new, especially when both options would basically lead to the same end goal.
              In other words, IM LAZY lmaoo
            </div>



            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/nope.png" alt="img">
              </div>
            </div>

            <div class="text-scroll para">
              Nope, I was wrong. Pkexec was not a privesc here. However, the sudo version is interesting. It's older
              than <b>1.8.28</b> making it vulnerable to <u><b><a
                    href="https://www.exploit-db.com/exploits/47502">CVE-2019-14287</a></b></u>. This will surely give
              me root now
            </div>


            <br>
            <div class="blog-sub-heading text-scroll">
              It Worked!!
            </div>
            <br>



            <div class="blog-text-img">
              <div class="img-scroll">
                <img src="../images/agentsudoctf/root.png" alt="img">
              </div>
            </div>




            <br>
            <div class="blog-sub-heading text-scroll">
              <u><a href="https://tryhackme.com/room/agentsudoctf">Answers</a></u>
            </div>
            <br>
            <div class="text-scroll para">


              <pre>
<b>How many open ports?</b>
3

<b>How you redirect yourself to a secret page?</b>
user-agent

<b>What is the agent name?</b>
chris

<hr>
<b>FTP password</b>
crystal

<b>Zip file password</b>
alien

<b>steg password</b>
Area51

<b>Who is the other agent (in full name)?</b>
james

<b>SSH password</b>
hackerrules!

<hr>
<b>What is the user flag?</b>
b03d975e8c92a7c04146cfa7a5a313c7

<b>What is the incident of the photo called?</b> <u><a href="https://lens.google.com/search?ep=gisbubb&hl=en-IN&re=df&p=Acn1BYdtzTVEpuVO05zz65vbC_p0b3DrfYKvOjrgOU0ViqvZjhqU8S5qXQsMFTC-Tqj1tgpxCEGgZCBU6tc08CyTwmhH3u_6AUSQgRx4TO2H3ADw8Y5xLAsFbKQ8fnulDd8J5MbihAa4PGdfCflhqLCqT-2culARGfXTK_imgATlnTKEzwTVWWYEIll8mF34g_C9KRiuJ1YboewLj4V6qizrXdEiTLT8w_PM1FZNWJLZV5ZX8oCT3FvP6oqlBL9gV1YoWhACe2ux5cdHcF8dGVHIypGxIvmoW2S5B7PYpa0dRugbnarpQtDd0U-nTmsDbh0%3D#lns=W251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLDEsIkVrY0tKR016WXpBMlpqSmhMV1JrTm1ZdE5HVm1NaTFoTlRBeUxUVmlOREJsT1dNNE9XVTBNQklmWTNwSVgwdzNSRUo0VVZsV2MwWldkMUYzZG5veE4wZ3lUV3cyU214NFp3PT0iLG51bGwsbnVsbCxbW251bGwsbnVsbCwiMi0xMiJdLFsiZjlhNTU4OTktOTZkMS00YjIwLWIyYTItM2IyMzc1MzE3N2M3Il1dLG51bGwsbnVsbCxudWxsLFtudWxsLDEyLFtdXV0="><i>find image source</i></a></u>
Roswell alien autopsy

<hr>
<b>CVE number for the escalation </b>
CVE-2019-14287

<b>What is the root flag?</b>
b53a02f55b57d4439e3341834d70c062

<b>(Bonus) Who is Agent R?</b>
DesKel

</pre>

            </div>

            <div class="signature">
              <span class="text-scroll">&nbsp;&nbsp;&nbsp;Yashwardhan ~ 5pid3rh7ck3r</span>
            </div>

          </div>

        </div>

      </div>








      <!-- HEADPHONE IMG -->
      <!-- <div class="headphone img text">
    <img src="images/headphone.png" title="headphone zone" class="text" alt="headphone">
  </div> -->
      <!-- HEADPHONE IMG -->



      <!-- progress-bar -->
      <div class="progress-bar-container fade-in">
        <div class="progressbar"></div>
      </div>
      <!-- progress-bar -->

    </div>




    <!-- NAVIGATION CONTENT -->

    <div class="navigation-content">
      <div class="navigation-logo hover opacity">
        <a href="#" class="text">Yashwardhan</a>
      </div>
      <ul class="navigation-ul">
        <li><a href="../index.html" data-text="Home" data-img="images/02background.gif">Home</a></li>
        <li><a href="../about_me.html" data-text="About Me" data-img="images/about_page_img.jpg">About Me</a></li>
        <li><a href="../my_projects.html" data-text="Projects" data-img="images/projects_bg.jpg">Projects</a></li>
        <li><a href="../my_blogs.html" data-text="Blogs" data-img="images/Blog_img.jpg">Blogs</a></li>
        <li><a href="../contact-one.html" data-text="Contact" data-img="images/yellow_city.jpg">Contact</a>
        </li>
      </ul>
      <div class="navigation-close hover about-close opacity">
        <div class="navigation-close-line"></div>
        <div class="navigation-close-line"></div>
      </div>

      <div class="project-preview"></div>


      <!-- HEADPHONE IMG -->
      <!-- <div class="headphone-navigation opacity">
        <img src="../images/headphone.png" title="headphone zone" class="text" alt="headphone">
      </div> -->
      <!-- HEADPHONE IMG -->


      <!-- SOCIAL MEDIA LINKS -->
      <!-- <div class="social-media-links-navigation">
        <ul>
          <li><a href="#" class="text hover opacity">YT</a></li>
          <li><a href="#" class="text hover opacity">FB</a></li>
          <li><a href="#" class="text hover opacity">IG</a></li>
        </ul>
      </div> -->
      <!-- SOCIAL MEDIA LINKS -->

    </div>

    <!-- NAVIGATION CONTENT -->





  </main>

  <script src="../js/jquery.min.js"></script>
  <script src="../js/bez.js"></script>
  <script src="../js/pace.js"></script>
  <script src="../js/index.js"></script>


</body>

</html>